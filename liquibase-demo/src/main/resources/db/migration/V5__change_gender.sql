DROP TABLE post;
DROP TABLE friends;
DROP TABLE users;
DROP TABLE school;

CREATE TABLE IF NOT EXISTS school(
                       id INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
                       title VARCHAR(100),
                       address VARCHAR(100)
);

CREATE TABLE IF NOT EXISTS users(
                        id INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
                        name VARCHAR(100),
                        age INT,
                        gender VARCHAR(1),
                        CONSTRAINT check_gender CHECK
                            (gender IN ('F', 'M')),
                        school_id INT,
                        FOREIGN KEY (school_id) REFERENCES school(id) ON DELETE SET NULL
);

CREATE TABLE IF NOT EXISTS post(
                        id INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
                        content VARCHAR(2048),
                        user_id INT,
                        FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE
);

CREATE TABLE IF NOT EXISTS friends(
                                user_id INT,
                                user2_id INT,
                                FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE,
                                FOREIGN KEY (user2_id) REFERENCES users(id) ON DELETE CASCADE,
                                CHECK (friends.user_id != friends.user2_id)
);

INSERT INTO school VALUES (1, 'Школа №1', 'Морозова, 12');
INSERT INTO school VALUES (2, 'Школа №2', 'Лебедева, 1');
INSERT INTO school VALUES (3, 'Школа №3', 'Гагарина, 5');
INSERT INTO school VALUES (4, 'Школа №4', 'Луначарского, 92');


INSERT INTO users VALUES (1, 'Николай', 12, 'M', 1);
INSERT INTO users VALUES (2, 'Паша', 16, 'M', 1);
INSERT INTO users VALUES (3, 'Оля', 11, 'F', 2);
INSERT INTO users VALUES (4, 'Наташа', 15, 'F', 3);
INSERT INTO users VALUES (5, 'Петя', 13, 'M', 4);

INSERT INTO friends VALUES (1, 2);
INSERT INTO friends VALUES (3, 4);
INSERT INTO friends VALUES (1, 5);

INSERT INTO post VALUES (1, 'Привет всем', 1);
INSERT INTO post VALUES (2, 'Как дела', 1);
INSERT INTO post VALUES (3, 'Скоро в школу', 2);
INSERT INTO post VALUES (4, 'Готовлюсь к экзаменам', 1);